-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.analytics (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  user_id character varying,
  event_type character varying NOT NULL,
  event_data jsonb DEFAULT '{}'::jsonb,
  user_agent text,
  ip_address character varying,
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT analytics_pkey PRIMARY KEY (id),
  CONSTRAINT analytics_user_id_users_id_fk FOREIGN KEY (user_id) REFERENCES public.users(id)
);
CREATE TABLE public.bookings (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  listing_id character varying NOT NULL,
  guest_id character varying NOT NULL,
  host_id character varying NOT NULL,
  check_in timestamp without time zone NOT NULL,
  check_out timestamp without time zone NOT NULL,
  guests integer NOT NULL,
  total_price numeric NOT NULL,
  status character varying NOT NULL DEFAULT 'pending'::character varying,
  notes text,
  created_at timestamp without time zone DEFAULT now(),
  updated_at timestamp without time zone DEFAULT now(),
  CONSTRAINT bookings_pkey PRIMARY KEY (id),
  CONSTRAINT bookings_guest_id_users_id_fk FOREIGN KEY (guest_id) REFERENCES public.users(id),
  CONSTRAINT bookings_host_id_users_id_fk FOREIGN KEY (host_id) REFERENCES public.users(id),
  CONSTRAINT bookings_listing_id_listings_id_fk FOREIGN KEY (listing_id) REFERENCES public.listings(id)
);
CREATE TABLE public.component_usage (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  component_id character varying NOT NULL,
  user_id character varying,
  page character varying NOT NULL,
  context jsonb DEFAULT '{}'::jsonb,
  performance_metrics jsonb DEFAULT '{}'::jsonb,
  user_agent text,
  ip_address character varying,
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT component_usage_pkey PRIMARY KEY (id),
  CONSTRAINT component_usage_component_id_ui_components_id_fk FOREIGN KEY (component_id) REFERENCES public.ui_components(id),
  CONSTRAINT component_usage_user_id_users_id_fk FOREIGN KEY (user_id) REFERENCES public.users(id)
);
CREATE TABLE public.listings (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  host_id character varying NOT NULL,
  title character varying NOT NULL,
  description text NOT NULL,
  property_type USER-DEFINED NOT NULL,
  price_per_night numeric NOT NULL,
  currency character varying NOT NULL DEFAULT 'USD'::character varying,
  location character varying NOT NULL,
  city character varying NOT NULL,
  address text,
  latitude numeric,
  longitude numeric,
  max_guests integer NOT NULL,
  bedrooms integer,
  bathrooms integer,
  amenities jsonb DEFAULT '[]'::jsonb,
  images jsonb DEFAULT '[]'::jsonb,
  is_active boolean NOT NULL DEFAULT true,
  is_verified boolean NOT NULL DEFAULT false,
  rating numeric DEFAULT 0.0,
  review_count integer NOT NULL DEFAULT 0,
  view_count integer NOT NULL DEFAULT 0,
  tags jsonb DEFAULT '[]'::jsonb,
  contact_methods jsonb DEFAULT '{}'::jsonb,
  created_at timestamp without time zone DEFAULT now(),
  updated_at timestamp without time zone DEFAULT now(),
  CONSTRAINT listings_pkey PRIMARY KEY (id),
  CONSTRAINT listings_host_id_users_id_fk FOREIGN KEY (host_id) REFERENCES public.users(id)
);
CREATE TABLE public.messages (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  conversation_id character varying NOT NULL,
  sender_id character varying NOT NULL,
  receiver_id character varying NOT NULL,
  listing_id character varying,
  content text NOT NULL,
  is_read boolean NOT NULL DEFAULT false,
  message_type character varying NOT NULL DEFAULT 'text'::character varying,
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT messages_pkey PRIMARY KEY (id),
  CONSTRAINT messages_sender_id_users_id_fk FOREIGN KEY (sender_id) REFERENCES public.users(id),
  CONSTRAINT messages_receiver_id_users_id_fk FOREIGN KEY (receiver_id) REFERENCES public.users(id),
  CONSTRAINT messages_listing_id_listings_id_fk FOREIGN KEY (listing_id) REFERENCES public.listings(id)
);
CREATE TABLE public.reports (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  reporter_id character varying NOT NULL,
  target_type character varying NOT NULL,
  target_id character varying NOT NULL,
  reason character varying NOT NULL,
  description text,
  status character varying NOT NULL DEFAULT 'pending'::character varying,
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT reports_pkey PRIMARY KEY (id),
  CONSTRAINT reports_reporter_id_users_id_fk FOREIGN KEY (reporter_id) REFERENCES public.users(id)
);
CREATE TABLE public.reviews (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  listing_id character varying NOT NULL,
  reviewer_id character varying NOT NULL,
  host_id character varying NOT NULL,
  booking_id character varying,
  rating integer NOT NULL,
  comment text,
  is_visible boolean NOT NULL DEFAULT true,
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT reviews_pkey PRIMARY KEY (id),
  CONSTRAINT reviews_host_id_users_id_fk FOREIGN KEY (host_id) REFERENCES public.users(id),
  CONSTRAINT reviews_listing_id_listings_id_fk FOREIGN KEY (listing_id) REFERENCES public.listings(id),
  CONSTRAINT reviews_reviewer_id_users_id_fk FOREIGN KEY (reviewer_id) REFERENCES public.users(id),
  CONSTRAINT reviews_booking_id_bookings_id_fk FOREIGN KEY (booking_id) REFERENCES public.bookings(id)
);
CREATE TABLE public.services (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  provider_id character varying NOT NULL,
  title character varying NOT NULL,
  description text NOT NULL,
  category character varying NOT NULL,
  price_type character varying NOT NULL,
  price numeric NOT NULL,
  location character varying NOT NULL,
  images jsonb DEFAULT '[]'::jsonb,
  is_active boolean NOT NULL DEFAULT true,
  rating numeric DEFAULT 0.0,
  review_count integer NOT NULL DEFAULT 0,
  created_at timestamp without time zone DEFAULT now(),
  updated_at timestamp without time zone DEFAULT now(),
  CONSTRAINT services_pkey PRIMARY KEY (id),
  CONSTRAINT services_provider_id_users_id_fk FOREIGN KEY (provider_id) REFERENCES public.users(id)
);
CREATE TABLE public.ui_components (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  name character varying NOT NULL UNIQUE,
  display_name character varying NOT NULL,
  description text,
  category character varying NOT NULL,
  component_type character varying NOT NULL,
  version character varying NOT NULL DEFAULT '1.0.0'::character varying,
  is_active boolean NOT NULL DEFAULT true,
  is_public boolean NOT NULL DEFAULT false,
  config jsonb NOT NULL,
  template text,
  styles jsonb DEFAULT '{}'::jsonb,
  interactions jsonb DEFAULT '{}'::jsonb,
  responsive jsonb DEFAULT '{}'::jsonb,
  variants jsonb DEFAULT '[]'::jsonb,
  usage_count integer NOT NULL DEFAULT 0,
  created_by character varying,
  updated_by character varying,
  tags jsonb DEFAULT '[]'::jsonb,
  dependencies jsonb DEFAULT '[]'::jsonb,
  preview_image character varying,
  created_at timestamp without time zone DEFAULT now(),
  updated_at timestamp without time zone DEFAULT now(),
  CONSTRAINT ui_components_pkey PRIMARY KEY (id),
  CONSTRAINT ui_components_updated_by_users_id_fk FOREIGN KEY (updated_by) REFERENCES public.users(id),
  CONSTRAINT ui_components_created_by_users_id_fk FOREIGN KEY (created_by) REFERENCES public.users(id)
);
CREATE TABLE public.user_preferences (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  user_id character varying NOT NULL,
  age integer,
  gender character varying,
  occupation character varying,
  lifestyle jsonb DEFAULT '{}'::jsonb,
  budget_min numeric,
  budget_max numeric,
  preferred_locations jsonb DEFAULT '[]'::jsonb,
  is_looking_for_roommate boolean NOT NULL DEFAULT false,
  profile_visibility character varying NOT NULL DEFAULT 'private'::character varying,
  created_at timestamp without time zone DEFAULT now(),
  updated_at timestamp without time zone DEFAULT now(),
  CONSTRAINT user_preferences_pkey PRIMARY KEY (id),
  CONSTRAINT user_preferences_user_id_users_id_fk FOREIGN KEY (user_id) REFERENCES public.users(id)
);
CREATE TABLE public.users (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  email character varying NOT NULL UNIQUE,
  first_name character varying,
  last_name character varying,
  profile_image_url character varying,
  phone_number character varying,
  password_hash character varying,
  role character varying NOT NULL DEFAULT 'guest'::character varying,
  is_verified boolean NOT NULL DEFAULT false,
  verification_status character varying DEFAULT 'pending'::character varying,
  auth_id character varying UNIQUE,
  email_verified boolean NOT NULL DEFAULT false,
  phone_verified boolean NOT NULL DEFAULT false,
  email_verified_at timestamp without time zone,
  phone_verified_at timestamp without time zone,
  last_sign_in_at timestamp without time zone,
  raw_user_meta_data jsonb DEFAULT '{}'::jsonb,
  raw_app_meta_data jsonb DEFAULT '{}'::jsonb,
  signup_method character varying NOT NULL DEFAULT 'local'::character varying,
  onboarding_step integer NOT NULL DEFAULT 1,
  created_at timestamp without time zone DEFAULT now(),
  updated_at timestamp without time zone DEFAULT now(),
  CONSTRAINT users_pkey PRIMARY KEY (id)
);
CREATE TABLE public.wishlist (
  id character varying NOT NULL DEFAULT gen_random_uuid(),
  user_id character varying NOT NULL,
  listing_id character varying NOT NULL,
  created_at timestamp without time zone DEFAULT now(),
  CONSTRAINT wishlist_pkey PRIMARY KEY (id),
  CONSTRAINT wishlist_listing_id_listings_id_fk FOREIGN KEY (listing_id) REFERENCES public.listings(id),
  CONSTRAINT wishlist_user_id_users_id_fk FOREIGN KEY (user_id) REFERENCES public.users(id)
);